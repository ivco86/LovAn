# Telegram Bot –∑–∞ AI Gallery ü§ñ

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–±–∞–≤—è–π —Å–Ω–∏–º–∫–∏ –æ—Ç Telegram –≥—Ä—É–ø–∏ –∏ –∫–∞–Ω–∞–ª–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ —Ç–≤–æ—è—Ç–∞ AI Gallery!

## –§—É–Ω–∫—Ü–∏–∏

‚ú® **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø–∞–∑–≤–∞–Ω–µ** - –í—Å—è–∫–∞ —Å–Ω–∏–º–∫–∞ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∞ –≤ –≥—Ä—É–ø–∞—Ç–∞ —Å–µ –∑–∞–ø–∞–∑–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
ü§ñ **AI –∞–Ω–∞–ª–∏–∑** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞ –æ–ø–∏—Å–∞–Ω–∏—è –∏ —Ç–∞–≥–æ–≤–µ
üë• **–ì—Ä—É–ø–æ–≤–∞ –ø–æ–¥–¥—Ä—ä–∂–∫–∞** - –†–∞–±–æ—Ç–∏ –≤ –≥—Ä—É–ø–∏, –∫–∞–Ω–∞–ª–∏ –∏ –ª–∏—á–Ω–∏ —Å—ä–æ–±—â–µ–Ω–∏—è
üîí **–°–∏–≥—É—Ä–Ω–æ—Å—Ç** - –û–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏ –≥—Ä—É–ø–∏
üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** - –ö–æ–º–∞–Ω–¥–∞ –∑–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Ç–∞ –Ω–∞ –≥–∞–ª–µ—Ä–∏—è—Ç–∞

## –ë—ä—Ä–∑ —Å—Ç–∞—Ä—Ç

### 1. –°—ä–∑–¥–∞–π Telegram –±–æ—Ç

1. –û—Ç–≤–æ—Ä–∏ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –ò–∑–ø—Ä–∞—Ç–∏ `/newbot`
3. –ò–∑–±–µ—Ä–∏ –∏–º–µ –∑–∞ –±–æ—Ç–∞ (–Ω–∞–ø—Ä. "My AI Gallery Bot")
4. –ò–∑–±–µ—Ä–∏ username (–Ω–∞–ø—Ä. "myaigallery_bot")
5. –ö–æ–ø–∏—Ä–∞–π —Ç–æ–∫–µ–Ω–∞ –∫–æ–π—Ç–æ –ø–æ–ª—É—á–∏—à (–Ω–µ—â–æ –∫–∞—Ç–æ `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2. –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–π –±–æ—Ç–∞

–°—ä–∑–¥–∞–π `.env` —Ñ–∞–π–ª –≤ –≥–ª–∞–≤–Ω–∞—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:

```bash
cp .env.example .env
```

–†–µ–¥–∞–∫—Ç–∏—Ä–∞–π `.env` —Ñ–∞–π–ª–∞ –∏ –¥–æ–±–∞–≤–∏ —Ç–≤–æ—è Telegram bot token:

```env
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
GALLERY_API_URL=http://localhost:5000
AUTO_ANALYZE=true
AI_STYLE=classic
```

### 4. –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ

–ü—ä—Ä–≤–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–π AI Gallery —Å—ä—Ä–≤—ä—Ä–∞:

```bash
python app.py
```

–°–ª–µ–¥ —Ç–æ–≤–∞ –≤ –¥—Ä—É–≥ —Ç–µ—Ä–º–∏–Ω–∞–ª —Å—Ç–∞—Ä—Ç–∏—Ä–∞–π –±–æ—Ç–∞:

```bash
python telegram_bot.py
```

### 5. –ò–∑–ø–æ–ª–∑–≤–∞–π –±–æ—Ç–∞

#### –õ–∏—á–µ–Ω —á–∞—Ç
1. –ù–∞–º–µ—Ä–∏ —Ç–≤–æ—è –±–æ—Ç –≤ Telegram (–ø–æ username)
2. –ù–∞—Ç–∏—Å–Ω–∏ `/start`
3. –ò–∑–ø—Ä–∞—Ç–∏ —Å–Ω–∏–º–∫–∞

#### –ì—Ä—É–ø–∞
1. –î–æ–±–∞–≤–∏ –±–æ—Ç–∞ –∫—ä–º –≥—Ä—É–ø–∞ (–∫–∞—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
2. –ë–æ—Ç—ä—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —â–µ –∑–∞–ø–∞–∑–≤–∞ –≤—Å–∏—á–∫–∏ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∏ —Å–Ω–∏–º–∫–∏

## –ö–æ–º–∞–Ω–¥–∏

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ü–æ–∫–∞–∑–≤–∞ welcome —Å—ä–æ–±—â–µ–Ω–∏–µ |
| `/status` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Ç–∞ –Ω–∞ –≥–∞–ª–µ—Ä–∏—è—Ç–∞ |
| `/help` | –ü–æ–∫–∞–∑–≤–∞ –ø–æ–º–æ—â–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Environment –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏

| –ü—Ä–æ–º–µ–Ω–ª–∏–≤–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ |
|------------|----------|-----------------|
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω –Ω–∞ –±–æ—Ç–∞ –æ—Ç BotFather | *–∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∞* |
| `GALLERY_API_URL` | URL –Ω–∞ AI Gallery API | `http://localhost:5000` |
| `PHOTOS_DIR` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∑–∞ —Å–Ω–∏–º–∫–∏ | `photos` |
| `AUTO_ANALYZE` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω AI –∞–Ω–∞–ª–∏–∑ | `true` |
| `AI_STYLE` | –°—Ç–∏–ª –Ω–∞ –∞–Ω–∞–ª–∏–∑ | `classic` |
| `ALLOWED_CHATS` | –†–∞–∑—Ä–µ—à–µ–Ω–∏ chat IDs | *(–≤—Å–∏—á–∫–∏)* |

### AI –°—Ç–∏–ª–æ–≤–µ

–ú–æ–∂–µ—à –¥–∞ –∏–∑–±–µ—Ä–µ—à —Ä–∞–∑–ª–∏—á–Ω–∏ —Å—Ç–∏–ª–æ–≤–µ –∑–∞ AI –∞–Ω–∞–ª–∏–∑:

- `classic` - –ë–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω, —É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω —Å—Ç–∏–ª
- `detailed` - –ú–Ω–æ–≥–æ –¥–µ—Ç–∞–π–ª–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ
- `tags` - –§–æ–∫—É—Å –≤—ä—Ä—Ö—É —Ç–∞–≥–æ–≤–µ
- `custom` - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω prompt

### –û–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –Ω–∞ –¥–æ—Å—Ç—ä–ø–∞

–ó–∞ –¥–∞ –æ–≥—Ä–∞–Ω–∏—á–∏—à –∫–æ–∏ –≥—Ä—É–ø–∏ –º–æ–≥–∞—Ç –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –±–æ—Ç–∞:

1. –î–æ–±–∞–≤–∏ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–∞—Ç–∞
2. –ò–∑–ø—Ä–∞—Ç–∏ —Å–Ω–∏–º–∫–∞ –≤ –≥—Ä—É–ø–∞—Ç–∞
3. –í–∏–∂ –ª–æ–≥–æ–≤–µ—Ç–µ –Ω–∞ –±–æ—Ç–∞ - —â–µ –≤–∏–¥–∏—à chat ID (–Ω–∞–ø—Ä. `-1001234567890`)
4. –î–æ–±–∞–≤–∏ chat ID –≤ `.env`:

```env
ALLOWED_CHATS=-1001234567890,-1009876543210
```

## –ü—Ä–∏–º–µ—Ä–∏ –∑–∞ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ

### –ü—Ä–∏–º–µ—Ä 1: –°–µ–º–µ–π–Ω–∞ –≥–∞–ª–µ—Ä–∏—è

```env
TELEGRAM_BOT_TOKEN=your_token
AUTO_ANALYZE=true
AI_STYLE=detailed
ALLOWED_CHATS=-1001234567890  # –°–∞–º–æ —Å–µ–º–µ–π–Ω–∞—Ç–∞ –≥—Ä—É–ø–∞
```

### –ü—Ä–∏–º–µ—Ä 2: –§–æ—Ç–æ –∞—Ä—Ö–∏–≤ –±–µ–∑ AI

```env
TELEGRAM_BOT_TOKEN=your_token
AUTO_ANALYZE=false  # –ó–∞–ø–∞–∑–≤–∞ —Å–Ω–∏–º–∫–∏ –±–µ–∑ –∞–Ω–∞–ª–∏–∑
```

### –ü—Ä–∏–º–µ—Ä 3: –ü—É–±–ª–∏—á–Ω–∞ –≥–∞–ª–µ—Ä–∏—è

```env
TELEGRAM_BOT_TOKEN=your_token
AUTO_ANALYZE=true
AI_STYLE=tags
ALLOWED_CHATS=  # –ü—Ä–∏–µ–º–∞ –æ—Ç –≤—Å–∏—á–∫–∏
```

## –†–∞–±–æ—Ç–µ–Ω –ø—Ä–æ—Ü–µ—Å

```
1. –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –∏–∑–ø—Ä–∞—â–∞ —Å–Ω–∏–º–∫–∞ –≤ Telegram –≥—Ä—É–ø–∞
        ‚Üì
2. –ë–æ—Ç—ä—Ç –ø–æ–ª—É—á–∞–≤–∞ —Å–Ω–∏–º–∫–∞—Ç–∞
        ‚Üì
3. –°–Ω–∏–º–∫–∞—Ç–∞ —Å–µ –∑–∞–ø–∞–∑–≤–∞ –≤ photos/ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ç–∞
        ‚Üì
4. –°–Ω–∏–º–∫–∞—Ç–∞ —Å–µ –¥–æ–±–∞–≤—è –≤ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏
        ‚Üì
5. (–ê–∫–æ AUTO_ANALYZE=true) AI –∞–Ω–∞–ª–∏–∑–∏—Ä–∞ —Å–Ω–∏–º–∫–∞—Ç–∞
        ‚Üì
6. –ë–æ—Ç—ä—Ç –∏–∑–ø—Ä–∞—â–∞ –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ + –æ–ø–∏—Å–∞–Ω–∏–µ
        ‚Üì
7. –°–Ω–∏–º–∫–∞—Ç–∞ –µ –≤–∏–¥–∏–º–∞ –≤ –≥–∞–ª–µ—Ä–∏—è—Ç–∞
```

## Troubleshooting

### –ë–æ—Ç–∞ –Ω–µ –æ—Ç–≥–æ–≤–∞—Ä—è

1. –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ TELEGRAM_BOT_TOKEN –µ –ø—Ä–∞–≤–∏–ª–µ–Ω
2. –£–≤–µ—Ä—Ä–∏ —Å–µ —á–µ app.py —Ä–∞–±–æ—Ç–∏ –Ω–∞ –ø—Ä–∞–≤–∏–ª–Ω–∏—è –ø–æ—Ä—Ç
3. –ü—Ä–æ–≤–µ—Ä–∏ –ª–æ–≥–æ–≤–µ—Ç–µ –∑–∞ –≥—Ä–µ—à–∫–∏

### –°–Ω–∏–º–∫–∏—Ç–µ –Ω–µ —Å–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞—Ç

1. –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ AI —Å—ä—Ä–≤–∏—Å–∞ —Ä–∞–±–æ—Ç–∏ (–≤–∏–∂ app.py –ª–æ–≥–æ–≤–µ)
2. –ü—Ä–æ–≤–µ—Ä–∏ `AUTO_ANALYZE=true` –≤ `.env`
3. –í–∏–∂ `/status` –≤ –±–æ—Ç–∞ –∑–∞ AI —Å—Ç–∞—Ç—É—Å

### "Unauthorized" –≥—Ä–µ—à–∫–∞

- –¢–æ–∫–µ–Ω—ä—Ç –µ –Ω–µ–≤–∞–ª–∏–¥–µ–Ω –∏–ª–∏ –∏–∑—Ç—Ä–∏—Ç
- –ü—Ä–æ–≤–µ—Ä–∏ —Å [@BotFather](https://t.me/botfather)

### –°–Ω–∏–º–∫–∏—Ç–µ –Ω–µ —Å–µ –≤–∏–∂–¥–∞—Ç –≤ –≥–∞–ª–µ—Ä–∏—è—Ç–∞

1. –ü—Ä–æ–≤–µ—Ä–∏ `PHOTOS_DIR` –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ç–∞
2. –£–≤–µ—Ä—Ä–∏ —Å–µ —á–µ `app.py` –≥–ª–µ–¥–∞ —Å—ä—â–∞—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
3. –ù–∞—Ç–∏—Å–Ω–∏ "Scan Directory" –≤ –≥–∞–ª–µ—Ä–∏—è—Ç–∞

## –°–∏–≥—É—Ä–Ω–æ—Å—Ç

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –ù–∏–∫–æ–≥–∞ –Ω–µ —Å–ø–æ–¥–µ–ª—è–π `TELEGRAM_BOT_TOKEN`
- –ò–∑–ø–æ–ª–∑–≤–∞–π `ALLOWED_CHATS` –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –Ω–∞ –¥–æ—Å—Ç—ä–ø–∞
- `.env` —Ñ–∞–π–ª–∞ –ù–ï —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –≤ git (–≤–µ—á–µ –µ –≤ `.gitignore`)

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –í–∏–∂ –ª–æ–≥–æ–≤–µ—Ç–µ –Ω–∞ –±–æ—Ç–∞

```bash
python telegram_bot.py 2>&1 | tee bot.log
```

### –ü—Ä–æ–≤–µ—Ä–∏ —Å—Ç–∞—Ç—É—Å –ø—Ä–µ–∑ Telegram

–ò–∑–ø—Ä–∞—Ç–∏ `/status` –Ω–∞ –±–æ—Ç–∞ –∑–∞ –¥–∞ –≤–∏–¥–∏—à:
- –ë—Ä–æ–π —Å–Ω–∏–º–∫–∏ –≤ –≥–∞–ª–µ—Ä–∏—è—Ç–∞
- AI —Å—Ç–∞—Ç—É—Å
- –ê–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏/–Ω–µ–∞–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ —Å–Ω–∏–º–∫–∏

## –†–∞–∑—à–∏—Ä–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω —Ä–µ—Å—Ç–∞—Ä—Ç –ø—Ä–∏ –≥—Ä–µ—à–∫–∞

–ò–∑–ø–æ–ª–∑–≤–∞–π `systemd` –∏–ª–∏ `supervisor` –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω —Ä–µ—Å—Ç–∞—Ä—Ç:

**systemd service –ø—Ä–∏–º–µ—Ä** (`/etc/systemd/system/telegram-gallery-bot.service`):

```ini
[Unit]
Description=Telegram Gallery Bot
After=network.target

[Service]
Type=simple
User=your_user
WorkingDirectory=/path/to/ai-gallery1986
Environment="PATH=/path/to/venv/bin"
ExecStart=/path/to/venv/bin/python telegram_bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

–°—Ç–∞—Ä—Ç–∏—Ä–∞–π:
```bash
sudo systemctl enable telegram-gallery-bot
sudo systemctl start telegram-gallery-bot
```

## –ü–æ–ª–µ–∑–Ω–∏ –ª–∏–Ω–∫–æ–≤–µ

- [Telegram Bot API](https://core.telegram.org/bots/api)
- [python-telegram-bot –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.python-telegram-bot.org/)
- [@BotFather](https://t.me/botfather) - –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –±–æ—Ç–æ–≤–µ

## –í—ä–ø—Ä–æ—Å–∏ –∏ –ø—Ä–æ–±–ª–µ–º–∏

–ê–∫–æ –∏–º–∞—à –≤—ä–ø—Ä–æ—Å–∏ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏, –ø—Ä–æ–≤–µ—Ä–∏:
1. –õ–æ–≥–æ–≤–µ—Ç–µ –Ω–∞ –±–æ—Ç–∞ –∏ app.py
2. `/status` –∫–æ–º–∞–Ω–¥–∞—Ç–∞ –≤ Telegram
3. API health endpoint: `http://localhost:5000/api/health`
